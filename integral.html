<!DOCTYPE html>
<html>
  <head>
    <title>Integral</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<style>
.leftColumn {
  float: left;
  width: 50%;
}
.rightColumn {
  float: right;
  width: 50%;
}
</style>
  </head>
  <body>
<p>Computing The Invariants of Intersection Algebras of Principal Monomial Ideals</p>
<p>This website allows users to compute the <span class="math inline"><em>F</em></span>-signature and Hilbert-Kunz multiplicity of intersection algebras of polynomial rings. The purpose of the site is to allow researchers the opportunity to test their questions about these invariants, while varying the parameters.</p>
<p>Definition: Let <span class="math inline"><em>R</em></span> be a commutative ring and <span class="math inline"><em>I</em></span>, <span class="math inline"><em>J</em></span> be two ideals of <span class="math inline"><em>R</em></span>. The intersection algebra of <span class="math inline"><em>I</em></span> and <span class="math inline"><em>J</em></span> is <span class="math inline"><em>B</em><sub><em>R</em></sub></span>(<span class="math inline"><em>I</em></span>,<span class="math inline"><em>J</em></span>) = <span class="math inline">&#x2295;</span> (<span class="math inline"><em>I</em><sup><em>r</em></sup></span> <span class="math inline">&#x2229;</span> <span class="math inline"><em>J</em><sup><em>s</em></sup></span>), where the sum runs over all <span class="math inline"><em>r</em></span>,<span class="math inline"><em>s</em></span> nonnegative integers.</p>
<p>In particular, let <span class="math inline"><em>R</em></span> = <span class="math inline" style="font-family: courier">R</span> <span class="math inline">[<em>x</em>]</span>, where <span class="math inline" style="font-family: courier">R</span> is the field of real numbers, and <span class="math inline"><em>I</em></span> = <span class="math inline">(<em>x</em><sup><em>a</em></sup>)</span> and <span class="math inline"><em>J</em></span> = <span class="math inline">(<em>x</em><sup><em>b</em></sup>)</span>, where the exponents are positive integers. This can be generalized to multiple variables.</p>
<p>By entering the data for n, and (<span class="math inline"><em>a</em><sub>1</sub></span>, ..., <span class="math inline"><em>a</em><sub><em>n</em></sub></span>), (<span class="math inline"><em>b</em><sub>1</sub></span>, ..., <span class="math inline"><em>b</em><sub><em>n</em></sub></span>) below, where <sup>a<sub>1</sub></sup>&frasl;<sub>b<sub>1</sub></sub> &#x2265; <sup>a<sub>2</sub></sup>&frasl;<sub>b<sub>2</sub></sub> &#x2265; ... &#x2265; <sup>a<sub>n</sub></sup>&frasl;<sub>b<sub>n</sub></sub>, one obtains the <span class="math inline"><em>F</em></span>-signature and Hilbert-Kunz multiplicity.</p>

    n<input id="inputN" class="input" type="text" onchange="updateTextboxes(this.value)">
    <div id="inputArea"></div>
    <input type="button" onclick="updateIntegral()" value="Submit">
    <br>
    <br>
    <div id="statusDisplay"></div>
    <u>Hilbert-Kunz:</u><br>
    <div id="hilbertKunz"></div>
    <u>F-signature:</u><br>
    <div id="fSignature"></div>
    <script>
const errorMessageN = "<span style=\"color: red\">Invalid value for n.</span>";
// Since we only want positive integers, everything has to be digits
const validInputPattern = /^\d+$/;
const inputSplit = '\n\n';
const hilbertKunz = document.getElementById("hilbertKunz");
const fSignature = document.getElementById("fSignature");
const statusDisplay = document.getElementById("statusDisplay");
const inputArea = document.getElementById("inputArea");
const serverUrl = "/gj/php/integral.php"

function errorMessage(variable, index) {
  return "<span style=\"color: red\">Invalid value for " + variable + 
    "<sub>" + index + "</sub></span><br>";
}

function notYetEnteredMessage(variable, index) {
  return "<span style=\"color: red\">Nothing entered for " + variable +
    "<sub>" + index + "</sub></span><br>";
}

var n = null;
var a = [];
var b = [];

function updateTextboxes(text) {
  if(text === '') {
    statusDisplay.innerHTML = '';
    inputArea.innerHTML = '';
    return;
  }
  n = parseInt(text);
  if(isNaN(n)) {
    statusDisplay.innerHTML = errorMessageN;
    inputArea.innerHTML = '';
    return;
  }
  var leftInnerHTML = "";
  var rightInnerHTML = "";
  for(i = 0; i < n; ++i) {
    let label = "a<sub>" + (i + 1) + "</sub>";
    let textbox = 
      "<input class=\"input inputA\" type=\"text\" onchange=\"updateInputA(" + i
      + ", this.value)\"><br>";
    leftInnerHTML += label + textbox;

    label = "b<sub>" + (i + 1) + "</sub>";
    textbox = 
      "<input class=\"input inputB\" type=\"text\" onchange=\"updateInputB(" + i
      + ", this.value)\"><br>";
    rightInnerHTML += label + textbox;
  }
  inputArea.innerHTML =
    "<div>" + 
      "<div class=\"leftColumn\">" + leftInnerHTML + "</div>" +
      "<div class=\"rightColumn\">" + rightInnerHTML + "</div>" +
    "</div>";
  // This is necessary because there might be an error message left over from
  // before. Anyways, if the number of inputs is changed, then there's no way
  // the answer is still the same.
  statusDisplay.innerHTML = '';
}

function updateInputA(i, text) {
  a[i] = text;
}

function updateInputB(i, text) {
  b[i] = text;
}

function updateIntegral() {

  var errorMessages = '';
  if(!n)
    errorMessages += errorMessageN;
  for(let i = 0; i < n; ++i) {
    if(!validInputPattern.test(a[i]))
      errorMessages += errorMessage('a', i + 1);
    if(!validInputPattern.test(b[i]))
      errorMessages += errorMessage('b', i + 1);
  }

  // No invalid values were found
  if(errorMessages === '') {
    statusDisplay.innerHTML = "Loading...";
    $.get(
        serverUrl + "?a[]=" + a.slice(0, n).join('&a[]=') + "&b[]=" + b.slice(0, n).join('&b[]='),
        data => {
          let results = data.split(inputSplit, 2);
          let hilbertKunzValue = results[0];
          let fSignatureValue = results[1];
          hilbertKunz.innerHTML = hilbertKunzValue;
          fSignature.innerHTML = fSignatureValue;
          statusDisplay.innerHTML = '';
        }
    );
  } else {
    statusDisplay.innerHTML = errorMessages;
  }
}
    </script>
  </body>
</html>
